{"version":3,"sources":["webpack:///./src/apis/loan.js","webpack:///./src/mixins/pager.js","webpack:///./src/mixins/crud.js","webpack:///./src/views/contract/index.vue","webpack:///./src/views/contract/conf.js","webpack:///src/views/contract/index.vue","webpack:///./src/views/contract/index.vue?c84d","webpack:///./src/views/contract/index.vue?e476"],"names":["createLoan","data","pretty","request","url","method","saveLoan","deleteLoan","id","submitApprove","approveHandler","isFirst","isPass","param1","param2","loanId","appId","approveFirstPass","approveFirstReject","approveEndPass","approveEndReject","genContractFile","downloadContract","params","currentPage","pageSizes","pageSize","total","query","computed","frontPageOptions","this","methods","getApiPager","pageNo","trim","name","setTotal","setQueryName","q","init","sizeChange","size","currentPageChange","page","beforeInit","afterInit","res","err","customField","$message","tableData","rows","render","_vm","_c","_self","attrs","on","conf","options","loadingTag","columns","scopedSlots","_u","key","fn","col","prop","label","row","_f","status","_v","_s","width","$event","genContract","downloadContractFile","staticRenderFns","Object","freeze","useIndex","useMultiSelect","slot","mixins","showInfo","items","value","map","rowArr","type","colspan","disabled","console","created","dialogVisible","editConf","component"],"mappings":"kHAAA,oWAGO,MAAMA,EAAcC,GAChBC,eAAOC,eAAQ,CAClBC,IAAK,eACLC,OAAQ,OACRJ,UAWKK,EAAYL,GACdC,eAAOC,eAAQ,CAClBC,IAAK,eACLC,OAAQ,MACRJ,KAAMA,KAIDM,EAAcC,GAChBN,eAAOC,eAAQ,CAClBC,IAAK,gBAAkBI,EACvBH,OAAQ,YAKHI,EAAgBD,GAClBN,eAAOC,eAAQ,CAClBC,IAAK,wBACLC,OAAQ,OACRJ,KAAM,CACFO,SAYZ,SAASE,EAAeC,EAASC,GAC7B,IAAIC,EAASF,EAAU,QAAU,MAC7BG,EAASF,EAAS,OAAS,SAC3BR,EAAO,YAAWS,KAAUC,IAChC,OAAO,SAAUC,GACb,OAAOb,eAAOC,eAAQ,CAClBC,IAAKA,EACLC,OAAQ,OACRJ,KAAM,CACFc,SACAC,MAAOD,OAMhB,MAAME,EAAmBP,EAAe,EAAG,GAC9CQ,EAAqBR,EAAe,EAAG,GACvCS,EAAiBT,EAAe,EAAG,GACnCU,EAAmBV,EAAe,EAAG,GAG5BW,EAAmBb,GACrBN,eAAOC,eAAQ,CAClBC,IAAK,uBACLC,OAAQ,OACRJ,KAAM,CACFO,SAMCc,EAAmBd,GAAMN,eAAOC,eAAQ,CACjDC,IAAK,qBACLC,OAAQ,MACRkB,OAAQ,CACJf,U,wGCxFO,OACXP,OACI,MAAO,CAEHuB,YAAa,EACbC,UAAW,CAAC,GAAI,GAAI,GAAI,IACxBC,SAAU,GACVC,MAAO,EACPC,MAAM,KAGdC,SAAS,CACLC,mBACI,MAAO,CACHN,YAAYO,KAAKP,YACjBE,SAASK,KAAKL,SACdD,UAAUM,KAAKN,UACfG,MAAMG,KAAKH,MACXD,MAAMI,KAAKJ,SAIvBK,QAAS,CAELC,cACI,IAAIV,EAAU,CACVW,OAAOH,KAAKP,YACZE,SAASK,KAAKL,UAKlB,OAHIK,KAAKH,OAA+B,KAAtBG,KAAKH,MAAMO,SACzBZ,EAAOa,KAAOL,KAAKH,OAEhBL,GAEXc,SAASV,GACLI,KAAKJ,MAAQA,GAGjBW,aAAaC,GACTR,KAAKH,MAAQW,EACbR,KAAKP,YAAc,EACnBO,KAAKS,QAGTC,WAAWC,GACRX,KAAKL,SAAWgB,EAChBX,KAAKS,QAGRG,kBAAkBC,GACdb,KAAKP,YAAcoB,EACnBb,KAAKS,U,YClDF,GACXR,QAAS,CACLa,aACI,OAAO,GAEXC,YACI,OAAO,MAGX,aAAa,cAGT,UAAWf,KAAKc,aACZ,OAGJ,IAAKE,EAAKC,SAAa9C,eAAOC,eAAQ,CAClCC,IAAK2B,KAAK3B,OACP2B,KAAKkB,YACR1B,OAAO,IACAQ,KAAKE,iBACLF,KAAKR,WAMhB,GADAQ,KAAKe,UAAUC,GACXC,EAAK,OAAOjB,KAAKmB,SAAS,QAE9BnB,KAAKoB,UAAL,OAAiBJ,QAAjB,IAAiBA,GAAjB,UAAiBA,EAAK9C,YAAtB,iBAAiB,EAAWA,YAA5B,iBAAiB,EAAiBA,YAAlC,aAAiB,EAAuBA,KAExC8B,KAAKM,SAAL,OAAcU,QAAd,IAAcA,GAAd,UAAcA,EAAK9C,YAAnB,iBAAc,EAAWA,YAAzB,aAAc,EAAiBmD,U,2CChC3C,IAAIC,EAAS,WAAkB,IAAIC,EAAIvB,KAAKwB,EAAGD,EAAIE,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,YAAY,CAACF,EAAG,eAAe,CAACG,GAAG,CAAC,SAAWJ,EAAIhB,gBAAgBiB,EAAG,SAAS,CAACE,MAAM,CAAC,QAAUH,EAAIK,KAAKC,QAAQ,YAAcN,EAAIxB,iBAAiB,KAAOwB,EAAIH,UAAU,WAAaG,EAAIO,WAAW,QAAUP,EAAIK,KAAKG,SAASJ,GAAG,CAAC,oBAAsBJ,EAAIX,kBAAkB,cAAcW,EAAIb,YAAYsB,YAAYT,EAAIU,GAAG,CAAC,CAACC,IAAI,SAASC,GAAG,SAASC,GAAK,MAAO,CAACZ,EAAG,kBAAkB,CAACE,MAAM,CAAC,MAAQ,MAAM,MAAQ,SAAS,KAAOU,EAAIC,KAAK,MAAQD,EAAIE,OAAON,YAAYT,EAAIU,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,UAAS,IAAEI,IAAO,MAAO,CAACf,EAAG,SAAS,CAACE,MAAM,CAAC,KAAOH,EAAIiB,GAAG,gBAAPjB,CAAwBgB,EAAIE,UAAU,CAAClB,EAAImB,GAAGnB,EAAIoB,GAAGpB,EAAIiB,GAAG,eAAPjB,CAAuBgB,EAAIE,gBAAgB,MAAK,QAAW,CAACP,IAAI,OAAOC,GAAG,SAASC,GAAK,MAAO,CAACZ,EAAG,kBAAkB,CAACE,MAAM,CAAC,MAAQU,EAAIE,MAAM,MAAQF,EAAIQ,OAAOZ,YAAYT,EAAIU,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,UAAS,IAAEI,IAAO,MAAO,CAACf,EAAG,YAAY,CAACE,MAAM,CAAC,SAAWa,EAAIE,OAAS,EAAE,KAAO,WAAWd,GAAG,CAAC,MAAQ,SAASkB,GAAQ,OAAOtB,EAAIuB,YAAYP,EAAI9D,OAAO,CAAC8C,EAAImB,GAAG,UAAUlB,EAAG,YAAY,CAACE,MAAM,CAAC,SAAWa,EAAIE,OAAS,EAAE,KAAO,WAAWd,GAAG,CAAC,MAAQ,SAASkB,GAAQ,OAAOtB,EAAIwB,qBAAqBR,EAAI9D,OAAO,CAAC8C,EAAImB,GAAG,cAAc,MAAK,aAAgB,IAE3tCM,EAAkB,GCFPC,SAAOC,OAAO,CACzBrB,QAAS,CACLsB,UAAU,EACVC,gBAAgB,GAEpBrB,QAAS,CACL,CACIO,MAAO,KACPD,KAAM,QAIV,CAAEC,MAAO,MAAOD,KAAM,iBAEtB,CACIC,MAAO,OACPD,KAAM,SACNgB,KAAM,UAEV,CACIf,MAAO,KACPM,MAAO,IACPP,KAAM,OACNgB,KAAM,W,gDCgBH,GACfhD,gBACAiD,uBACArD,SAEA,qBACA,2CACA,iCACA,GACA,aAEA,sCACA,2CACA,iCACA,aAIA,sGACA,oDAEA,wDAEAsD,YACA,sBAEA,sCACA,eACAC,OACA,EAAAtB,SAAAI,WAAAmB,aACA,EAAAvB,WAAAI,WAAAmB,eACA,EAAAvB,eAAAI,aAAAmB,sBACA,EAAAvB,UAAAI,WAAAmB,cACA,EAAAvB,gBAAAI,aAAAmB,oBACA,EAAAvB,eAAAI,WAAAmB,mBACA,EAAAvB,mBAAAI,YAAAmB,uBACA,EAAAvB,oBAAAI,YAAAmB,yBAEAC,IAAAC,mBAAAC,aAAAC,WAAAnC,OAAAoC,mBAGAhD,aAKA,OAJA,0BACA,kBACAgB,6BAEA,GAGAf,aACAgD,0BAGAC,UACA,aAEA9F,OACA,OACA0D,OACAE,kBACAV,aACA6C,iBACAC,eCrG8V,I,YCO1VC,EAAY,eACd,EACA7C,EACA0B,GACA,EACA,KACA,KACA,MAIa,aAAAmB,E","file":"js/chunk-484cc8de.c8e91bca.js","sourcesContent":["import { request, pretty } from '@/utils/request'\r\n\r\n\r\nexport const createLoan = (data) => {\r\n    return pretty(request({\r\n        url: '/loan/create',\r\n        method: 'post',\r\n        data,\r\n    }))\r\n}\r\nexport const queryLoan = (params, customField) => {\r\n    return pretty(request({\r\n        url: '/loan/list',\r\n        params,\r\n        ...customField\r\n    }))\r\n}\r\n\r\nexport const saveLoan = (data) => {\r\n    return pretty(request({\r\n        url: '/loan/update',\r\n        method: 'put',\r\n        data: data\r\n    }))\r\n}\r\n// /loan/delete/:id\r\nexport const deleteLoan = (id) => {\r\n    return pretty(request({\r\n        url: '/loan/delete/' + id,\r\n        method: 'delete',\r\n    }))\r\n}\r\n\r\n// 提交\r\nexport const submitApprove = id => {\r\n    return pretty(request({\r\n        url: '/loan/submitToApprove',\r\n        method: 'post',\r\n        data: {\r\n            id\r\n        }\r\n    }))\r\n}\r\n/**\r\n *  /approve/first/pass\r\n    /approve/first/reject\r\n    /approve/end/pass\r\n    /approve/end/reject\r\nloanId申请id\r\nappId申请id\r\n */\r\nfunction approveHandler(isFirst, isPass) {\r\n    let param1 = isFirst ? 'first' : 'end';\r\n    let param2 = isPass ? 'pass' : 'reject';\r\n    let url = `/approve/${param1}/${param2}`\r\n    return function (loanId) {\r\n        return pretty(request({\r\n            url: url,\r\n            method: 'post',\r\n            data: {\r\n                loanId,\r\n                appId: loanId\r\n            }\r\n        }))\r\n    }\r\n}\r\n\r\nexport const approveFirstPass = approveHandler(1, 1),\r\n    approveFirstReject = approveHandler(1, 0),\r\n    approveEndPass = approveHandler(0, 1),\r\n    approveEndReject = approveHandler(0, 0);\r\n\r\n\r\nexport const genContractFile = (id) => {\r\n    return pretty(request({\r\n        url: '/contract/createFile',\r\n        method: 'post',\r\n        data: {\r\n            id\r\n        }\r\n    }))\r\n}\r\n\r\n// 获取下载url\r\nexport const downloadContract = id => pretty(request({\r\n    url: '/contract/download',\r\n    method: 'get',\r\n    params: {\r\n        id\r\n    }\r\n}));","export default {\r\n    data(){\r\n        return {\r\n            // 前端的东西\r\n            currentPage: 1,\r\n            pageSizes: [10, 20, 30, 40], // 显示的可切换\r\n            pageSize: 10, // 当前的size\r\n            total: 0, // 总条数\r\n            query:'', // 查询条件\r\n        }\r\n    },\r\n    computed:{\r\n        frontPageOptions(){\r\n            return {\r\n                currentPage:this.currentPage,\r\n                pageSize:this.pageSize,\r\n                pageSizes:this.pageSizes,\r\n                query:this.query,\r\n                total:this.total\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        // 提供后端数据访问的参数\r\n        getApiPager(){\r\n            let params =  {\r\n                pageNo:this.currentPage,\r\n                pageSize:this.pageSize,\r\n            }\r\n            if (this.query && this.query.trim() !== \"\") {\r\n                params.name = this.query;\r\n            }\r\n            return params;\r\n        },\r\n        setTotal(total){\r\n            this.total = total;\r\n        },\r\n        // name的改变\r\n        setQueryName(q) {\r\n            this.query = q;\r\n            this.currentPage = 1;\r\n            this.init();\r\n        },\r\n        // pageSize的改变, 页显示数\r\n        sizeChange(size) {\r\n           this.pageSize = size;\r\n           this.init();\r\n        },\r\n        // 当前页的改变\r\n        currentPageChange(page) {\r\n            this.currentPage = page;\r\n            this.init();\r\n        },\r\n    }\r\n}","import { request, pretty } from '@/utils/request';\r\nexport default {\r\n    methods: {\r\n        beforeInit() {\r\n            return false;\r\n        },\r\n        afterInit(){\r\n            return null;\r\n        },\r\n        // 数据初始化\r\n        async init() {\r\n            // 需要url ,需要请求参数loadingTag\r\n            // 判断是否设置了参数\r\n            if (!await this.beforeInit()) { // 3.验证并执行beforeInit方法\r\n                return;\r\n            }\r\n            // 4.使用beforeInit方法传递的值\r\n            let [res, err] = await pretty(request({\r\n                url: this.url,\r\n                ...this.customField,\r\n                params:{\r\n                    ...this.getApiPager(),\r\n                    ...this.params// 自定义参数\r\n                }\r\n                    \r\n            }));\r\n            // 后续处理数据\r\n            this.afterInit(res);\r\n            if (err) return this.$message('请求失败')\r\n\r\n            this.tableData = res?.data?.data?.data?.data;\r\n            // 设置total\r\n            this.setTotal(res?.data?.data?.rows);\r\n        }\r\n\r\n\r\n    }\r\n}","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"approve\"}},[_c('GSearchQuery',{on:{\"setValue\":_vm.setQueryName}}),_c('GTable',{attrs:{\"options\":_vm.conf.options,\"pageOptions\":_vm.frontPageOptions,\"data\":_vm.tableData,\"loadingTag\":_vm.loadingTag,\"columns\":_vm.conf.columns},on:{\"handleCurrentChange\":_vm.currentPageChange,\"size-change\":_vm.sizeChange},scopedSlots:_vm._u([{key:\"status\",fn:function(col){return [_c('el-table-column',{attrs:{\"width\":\"140\",\"align\":\"center\",\"prop\":col.prop,\"label\":col.label},scopedSlots:_vm._u([{key:\"default\",fn:function({ row }){return [_c('el-tag',{attrs:{\"type\":_vm._f(\"contractColor\")(row.status)}},[_vm._v(_vm._s(_vm._f(\"contractText\")(row.status)))])]}}],null,true)})]}},{key:\"opts\",fn:function(col){return [_c('el-table-column',{attrs:{\"label\":col.label,\"width\":col.width},scopedSlots:_vm._u([{key:\"default\",fn:function({ row }){return [_c('el-button',{attrs:{\"disabled\":row.status > 5,\"type\":\"primary\"},on:{\"click\":function($event){return _vm.genContract(row.id)}}},[_vm._v(\"生成合同\")]),_c('el-button',{attrs:{\"disabled\":row.status < 5,\"type\":\"success\"},on:{\"click\":function($event){return _vm.downloadContractFile(row.id)}}},[_vm._v(\"下载合同\")])]}}],null,true)})]}}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default Object.freeze({\r\n    options: {\r\n        useIndex: false,\r\n        useMultiSelect: false,\r\n    },  // table属性\r\n    columns: [\r\n        {\r\n            label: \"姓名\",\r\n            prop: \"name\",\r\n            // width:\"20\"\r\n        },\r\n\r\n        { label: \"身份证\", prop: \"identity_card\" },\r\n        \r\n        {\r\n            label: \"合同状态\",\r\n            prop: \"status\",\r\n            slot: \"status\"\r\n        },\r\n        {\r\n            label: \"操作\",\r\n            width: 1000,\r\n            prop: \"opts\",\r\n            slot: \"opts\"\r\n        },\r\n\r\n    ] // column的配置\r\n})","<template>\r\n<!-- vue-fragment解決根元素 利用注釋來處理 -->\r\n    <div id=\"approve\">\r\n        <GSearchQuery @setValue=\"setQueryName\"></GSearchQuery>\r\n        <GTable :options=\"conf.options\" :pageOptions=\"frontPageOptions\" :data=\"tableData\" :loadingTag=\"loadingTag\"\r\n            :columns=\"conf.columns\" @handleCurrentChange=\"currentPageChange\" @size-change=\"sizeChange\">\r\n            <template v-slot:status=\"col\">\r\n                <el-table-column width=\"140\" align=\"center\" :prop=\"col.prop\" :label=\"col.label\">\r\n                    <template v-slot=\"{ row }\">\r\n                        <el-tag :type=\"row.status | contractColor\">{{ row.status | contractText }}</el-tag>\r\n                    </template>\r\n                </el-table-column>\r\n            </template>\r\n            <template v-slot:opts=\"col\">\r\n                <el-table-column :label=\"col.label\" :width=\"col.width\">\r\n                    <template v-slot=\"{ row }\">\r\n                        <el-button :disabled=\"row.status > 5\" @click=\"genContract(row.id)\" type=\"primary\">生成合同</el-button>\r\n                        <el-button :disabled=\"row.status < 5\" @click=\"downloadContractFile(row.id)\" type=\"success\">下载合同</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </template>\r\n        </GTable>\r\n\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport conf from './conf';\r\nimport { pager, crud } from '@/mixins';\r\nimport {\r\n  genContractFile,\r\n  downloadContract\r\n} from '@/apis/loan';\r\n\r\nimport { downloadFile } from '@/utils'\r\n\r\n\r\nimport Vue from 'vue';\r\nexport default {\r\n    name:'contract',\r\n    mixins: [pager, crud],\r\n    methods: {\r\n        // 通过\r\n        async genContract(id) {\r\n            if (!await this.confirm('是否确认生成合同?')) return;\r\n            let [res, err] = await genContractFile(id);\r\n            if (!res) return;\r\n            this.init();\r\n        },\r\n        async downloadContractFile(id) {\r\n            if (!await this.confirm('是否确认下载合同?')) return;\r\n            let [res, err] = await downloadContract(id);\r\n            if (!res) return;\r\n         \r\n            // console.log(res,'下载文件的url');\r\n            // 再次发起请求获取文件, 并实现下载\r\n            let url = res?.data?.data?.url;\r\n            if (!url)return this.$message.error(res.data.data);\r\n            // 为了使用之前配置的baseUrl:'/api' 干掉/api\r\n            await downloadFile(url.replace('/api',''),'贷款合同-' + id + '.docx')\r\n        },\r\n        showInfo(row) {\r\n            this.dialogVisible = true;\r\n            // 取出过滤器\r\n            let filterFn = Vue.filter('birthday');\r\n            this.editConf = {\r\n                items: [\r\n                    [{ key: 'id', label: 'id', value: row.id }],\r\n                    [{ key: 'name', label: '姓名', value: row.name }],\r\n                    [{ key: 'birthday', label: '出生日期', value: filterFn(row.birthday) }],\r\n                    [{ key: 'sex', label: '性别', value: row.sex }],\r\n                    [{ key: 'education', label: '教育程度', value: row.education }],\r\n                    [{ key: 'address1', label: '地址', value: row.address1 }],\r\n                    [{ key: 'mobile_phone', label: '手机号', value: row.mobile_phone }],\r\n                    [{ key: 'identity_card', label: '身份证', value: row.identity_card }]\r\n\r\n                ].map(rowArr => rowArr.map(item => ({ ...item, type: 'input', colspan: 24, attrs: { disabled: true } })))\r\n            }\r\n        },\r\n        beforeInit() {\r\n            this.url = \"/contract/list\";\r\n            this.customField = {\r\n                loadingTag: this.loadingTag\r\n            };\r\n            return true;\r\n        },\r\n        // 覆盖了crud的afterInit方法, 可以后续处理数据\r\n        afterInit(data) {\r\n            console.log('获取到数据:', data);\r\n        }\r\n    },\r\n    created() {\r\n        this.init();\r\n    },\r\n    data() {\r\n        return {\r\n            conf: conf,\r\n            loadingTag: 'tab7',\r\n            tableData: [],\r\n            dialogVisible: false,\r\n            editConf: {}\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0943df15&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}